<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
</head>
<body>

<h1>Admin Dashboard</h1>

<!-- ===== HOME PAGE IMAGE UPLOAD ===== -->
<h2>Upload Home Page Images</h2>

<form method="POST" enctype="multipart/form-data">
    <input type="file" name="home_image" required>
    <button type="submit">Upload to Home</button>
</form>

<div>
    <div>
    {% for img in home_images %}
        <div style="display:inline-block; margin:10px;">
            <img src="{{ url_for('static', filename='images/home/' + img) }}" width="150"><br>

            <form method="POST"
                  action="{{ url_for('delete_home_image', filename=img) }}"
                  onsubmit="return confirm('Delete this home image?');">
                <button type="submit" style="background:red;color:white;">
                    Delete
                </button>
            </form>
        </div>
    {% endfor %}
</div>

</div>

<hr>

<!-- ===== DESIGN IMAGE UPLOAD ===== -->
<h2>Upload Design Images</h2>

<form method="POST" enctype="multipart/form-data">
    <input type="file" name="design_image" required>
    <button type="submit">Upload Design</button>
</form>

<div>
    <div>
    {% for img in designs %}
        <div style="display:inline-block; margin:10px;">
            <img src="{{ url_for('static', filename='images/designs/' + img) }}" width="150"><br>

            <form method="POST"
                  action="{{ url_for('delete_design_image', filename=img) }}"
                  onsubmit="return confirm('Delete this design?');">
                <button type="submit" style="background:red;color:white;">
                    Delete
                </button>
            </form>
        </div>
    {% endfor %}
</div>

</div>

<hr>

<!-- ===== CUSTOMER SUBMISSIONS ===== -->
<h2>Customer Submissions</h2>

{% for c in customers %}
<div style="border:1px solid #ccc; padding:15px; margin-bottom:15px;">

    <p>
        <strong>Track ID:</strong> {{ c.track_id }} <br>
        <strong>Name:</strong> {{ c.name }} <br>
        <strong>Phone:</strong> {{ c.phone }} <br>
        <strong>Message:</strong> {{ c.message }} <br>
        <strong>Status:</strong>

            {% if c.status == 'approved' %}
                <span style="font-weight:bold; color:green;">Approved</span>
            {% elif c.status == 'rejected' %}
                <span style="font-weight:bold; color:red;">Rejected</span>
            {% else %}
                <span style="font-weight:bold; color:orange;">Pending</span>
            {% endif %}

    </p>

    <img src="{{ url_for('static', filename='images/customer_uploads/' + c.image) }}"
         width="150"><br><br>

    <!-- STATUS BUTTONS -->
    <form method="POST"
          action="{{ url_for('update_customer_status', index=loop.index0, status='approved') }}"
          style="display:inline;">
        <button type="submit">Approve</button>
    </form>

    <form method="POST"
          action="{{ url_for('update_customer_status', index=loop.index0, status='rejected') }}"
          style="display:inline;">
        <button type="submit">Reject</button>
    </form>
    
    <form method="POST"
          action="{{ url_for('delete_customer_submission', index=loop.index0) }}"
          style="display:inline;"
          onsubmit="return confirm('Delete this submission?');">
        <button style="background:red;color:white;">Delete</button>
    </form>

</div>
{% endfor %}

<hr>

<!-- ===== EMPLOYEE / LABOUR APPLICATIONS ===== -->
<h2>Labour / Employee Applications</h2>

{% if employees %}
    {% for e in employees %}
    <div style="border:1px solid #999; padding:15px; margin-bottom:15px; background:#fafafa;">

        <p>
            <strong>Track ID:</strong> {{ e.track_id }} <br>
            <strong>Name:</strong> {{ e.name }} <br>
            <strong>Phone:</strong> {{ e.phone }} <br>
            <strong>Aadhaar:</strong>
**** **** {{ e.aadhar[-4:] if e.aadhar else "XXXX" }} <br>
            <strong>Work Type:</strong> {{ e.work_type }} <br>
            <strong>Experience:</strong> {{ e.experience }} <br>

            <strong>Status:</strong>
            {% if e.status == 'approved' %}
                <span style="color:green;font-weight:bold;">Approved</span>
            {% elif e.status == 'rejected' %}
                <span style="color:red;font-weight:bold;">Rejected</span>
            {% else %}
                <span style="color:orange;font-weight:bold;">Pending</span>
            {% endif %}
            <br>

            <strong>Salary Model:</strong> {{ e.salary_model or "Not decided" }} <br>
            <strong>Admin Note:</strong> {{ e.admin_note or "â€”" }} <br>
            <strong>Applied On:</strong> {{ e.time }}
        </p>

        <p>
            <a href="tel:{{ e.phone }}">ðŸ“ž Call</a> |
            <a href="https://wa.me/91{{ e.phone }}" target="_blank">ðŸ’¬ WhatsApp</a>
        </p>

        {% if e.aadhar_file %}
            <a href="{{ url_for('static', filename='employee_docs/' + e.aadhar_file) }}"
               target="_blank">ðŸ“„ View Aadhaar</a>
        {% endif %}

        <br><br>

        <form method="POST"
              action="{{ url_for('update_employee_status', index=loop.index0, status='approved') }}"
              style="display:inline;">
            <button>Approve</button>
        </form>

        <form method="POST"
              action="{{ url_for('update_employee_status', index=loop.index0, status='rejected') }}"
              style="display:inline;">
            <button style="background:red;color:white;">Reject</button>
        </form>

        <br><br>

        <form method="POST"
              action="{{ url_for('update_employee_note', index=loop.index0) }}">
            <input name="salary_model"
                   placeholder="Salary / Per-piece model"
                   value="{{ e.salary_model }}"><br><br>

            <textarea name="admin_note"
                      placeholder="Admin notes">{{ e.admin_note }}</textarea><br><br>

            <button type="submit">Save Notes</button>
        </form>

    </div>
    {% endfor %}
{% else %}
    <p>No labour applications yet.</p>
{% endif %}



<br>
<a href="{{ url_for('logout') }}">Logout</a>

</body>
</html>
